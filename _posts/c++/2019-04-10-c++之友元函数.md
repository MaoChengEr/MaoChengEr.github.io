---
layout: post
comments: true
categories: Cplus
---
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

### 1.友元函数的意义

在c++中，使用类对数据进行分装盒隐藏，类的数据成员一般定义为私有成员，成员函数一般定义为共有的，以此提供与外界的接口。但是，有时候需要定义一些函数，这些函数既不是类的一部分，但又要频繁的去访问类的数据成员，这是可以将这些函数定义为该函数的有缘函数。

除了友元函数外还有友元类，两者统称为友元。

作用：为了提高程序的运行效率（即减少类型检查和安全性检查等都需要时间开销）

缺点：会破坏类的封装和隐藏性，是的非成员函数可以访问类的私有成员。

友元函数：

~~~c++
friend type funName(paramater)
~~~

友元函数：
​	友元函数是可以直接访问类的私有成员的非成员函数。它是定义在类外的普通函数，它不属于任何类，但需要在类的定义中加以声明，声明需要在函数名称前加上friend。
​	友元函数的声明可以放在类的私有部分，也可以党在共有部分，这没有区别，都说明是该类的一个友元函数。
​	一个函数可以是多个类的友元函数，只需要在各个类中分别声明。
​	友元函数的调用与一般函数的调用方式和原理一致。

友元类：
​	友元类的所有成员函数都是另一个类的友元函数，都可以访问另一个类的隐藏信息（包括私有成员和保护成员）

​	当一个雷可以存取另一个类的私有成员时，可以将该类声明为另一个类的友元类。

定义格式如下：

~~~c++
friend class 类名
~~~

其中：friend和class是关键字，类名必须是程序中的一个已经定义过的类。

ex：用以下语句说明B是A的友元类：

~~~c++
class A
{
    ...
public：
	friend class B;
	...
};
~~~

以上说明后，类B的所有成员函数都是类A的友元函数，能存取类A的私有成员和保护成员。

使用友元需要注意的地方：

* 友元关系不能被继承
* 友元关系是单向的，不具有交换性。若类B是类A的友元。类A不一定是类B的友元，要看在类中是否有相应的声明。
* 友元关系不具有传递性。若类B是类A的友元，类C不一定是类A的友元，在类中是否有相应的声明。

**NOTICE**:

1.类中通过使用关键字friend来修饰友元函数，但该函数并不是类的成员函数，其声明可以放在类的私有部分，也可以房子共有部分。友元函数的定义在类体外实现，不需要加类限定。

2.一个类中的成员函数可以是另一个类的友元函数。而且一个函数可以是多个类友元函数。

3.友元函数可以访问类中的私有成员和其他数据，但是访问不可直接使用数据成员，需要通过对对象进行引用。

4.友元函数会在调用上同一般函数一样，不必要通过对对象进行引用。

具体代码查看友元机理：

~~~c++
#include<iostream>
#include<string>
using namespace std;

class wheel;
class car{
public:
	car(char*pn);
	void run(wheel &w); //成员函数，左做成wheel类中友元函数实现
private:
	char name[20];
};

car::car(char*pn)
{
	strcpy(name,pn);
}

class wheel
{
public:
	wheel(int s);
	friend void car::run(wheel &w);//把car类的成员函数做了友元函数
private:
	int speed;
};

wheel::wheel(int s)
{
	speed=s;
}

int main(int argc,char const *argv[])
{
	wheel w(60);
	car c("New car");
	c.run(w);
	system("pause");
	return 0;
}

void car::run(wheel &w) //car类成员函数的实现
{
	cout<<"thr car is running"<<endl;
	cout<<"name:"<<name<<"\n"<<"speed:"<<w.speed<<endl;
}

~~~



















